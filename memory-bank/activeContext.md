# Active Context: LLVM IR to CFG Visualizer

## 現在の開発フォーカス

プロジェクトは実装段階に進んでおり、以下の点に焦点を当てています：

1. **UIの改善と洗練**
   - IRエディタの行番号表示機能の追加
   - カーソルとコードの位置ずれの修正
   - CFGノードのレイアウト最適化

2. **ユーザビリティの向上**
   - テキスト表示の読みやすさ改善
   - レスポンシブデザインの調整
   - ダークモード対応の強化

3. **デプロイとカスタムドメイン設定**
   - GitHub Actionsワークフローの最新化
   - カスタムドメイン（llvm-cfg.kakudo.org）の設定
   - デプロイプロセスの安定化

## 現在の課題と決定事項

### 解決済みの課題

1. **技術スタックの選定と実装**
   - Next.js + TypeScriptによるプロジェクト構造の確立
   - D3.js + dagre-d3によるCFG描画の実装
   - Prism.jsによるLLVM IRのシンタックスハイライト実装
   - Tailwind CSSによるスタイリングの適用

2. **コアコンポーネントの実装**
   - IREditorコンポーネントの実装（行番号表示機能付き）
   - CFGViewerコンポーネントの実装（ノードの自動サイズ調整機能付き）
   - Layoutコンポーネントによる画面分割の実装

3. **UIデザインの詳細**
   - レスポンシブデザインの実装
   - ダークモード対応の実装
   - エディタのユーザビリティ向上（カーソル位置の修正など）

### 進行中の課題

1. **パフォーマンス最適化**
   - 大規模なLLVM IRコードの処理効率化
   - レンダリングの最適化
   - メモリ使用量の削減

2. **機能拡張**
   - より複雑なLLVM IR構文のサポート
   - 追加の解析機能の実装
   - エクスポート機能の追加

3. **テスト強化**
   - ユニットテストの拡充
   - E2Eテストの実装
   - エッジケースの検証

## 次のステップ

短期的な次のステップは以下の通りです：

1. **ユーザーフィードバックの収集と対応**
   - 初期ユーザーからのフィードバック収集
   - 優先度の高い改善点の特定
   - ユーザビリティの継続的な向上

2. **追加機能の実装**
   - 複数関数のサポート強化
   - グラフの比較機能
   - コード解析の詳細表示

3. **パフォーマンス最適化**
   - 大規模コードの処理効率化
   - レンダリングの最適化
   - メモリ使用量の削減

4. **テスト拡充**
   - 自動テストの拡充
   - エッジケースの検証
   - ブラウザ互換性テスト

5. **ドキュメントの充実**
   - ユーザーガイドの作成
   - APIドキュメントの整備
   - 貢献ガイドラインの作成

## 中長期的な計画

中長期的には以下の機能拡張を予定しています：

1. **高度な解析機能**
   - データフロー解析の追加
   - 最適化パスの前後比較
   - 複数関数間の関係の可視化

2. **コラボレーション機能**
   - コード共有機能
   - リアルタイム協調編集
   - コメント・注釈機能

3. **インテグレーション**
   - 他のコンパイラツールとの連携
   - CI/CDパイプラインとの統合
   - エディタ拡張機能の提供

4. **拡張エクスポート機能**
   - 様々な形式（SVG、PNG、PDF）でのエクスポート
   - 解析結果のJSON/YAML出力
   - 埋め込み可能なウィジェット

5. **カスタマイズ機能**
   - ユーザー定義テーマ
   - レイアウトオプションのカスタマイズ
   - キーボードショートカットのカスタマイズ

## 現在の意思決定プロセス

プロジェクトの実装段階では、以下の原則に基づいて意思決定を行います：

1. **ユーザー体験を最優先**: 技術的な複雑さよりもユーザビリティを重視
2. **継続的な改善**: 完璧を目指すのではなく、継続的に改善を重ねる
3. **フィードバック駆動**: ユーザーフィードバックに基づいて優先順位を決定
4. **技術的健全性**: 短期的な解決策よりも長期的な保守性を考慮
5. **バランスの取れた拡張**: 基本機能の安定性を確保しつつ、新機能を追加

## 現在のリスクと対策

1. **拡張性リスク**
   - 機能追加によるコードの複雑化
   - 対策: モジュール化を徹底し、明確なインターフェースを維持

2. **パフォーマンスリスク**
   - 大規模IRコードや複雑なCFGの処理負荷
   - 対策: 遅延読み込みやメモ化などの最適化技術の適用

3. **ブラウザ互換性リスク**
   - 異なるブラウザでの動作の違い
   - 対策: クロスブラウザテストの実施と互換性レイヤーの導入

4. **ユーザー期待値リスク**
   - 専門ユーザーの高度な要求への対応
   - 対策: 優先順位付けを明確にし、段階的に機能を拡充
